def window():
    return '10m'
def groupby():
    return 'destination_security_id'
def algorithm(event):
    if event['event_name'] == 'Virus/Malware Detected' and event['event_action'] == 'Quarantine Failed':
        return 0.95
    return 0.0
def context(event_data):
    return (
        "Malware detected but quarantine failed on host "
        + event_data['destination_security_id']
        + " (" + event_data['file_path'] + ")."
    )
def criticality():
    return 'CRITICAL'
def tactic():
    return 'Execution (TA0002)'
def technique():
    return 'Malicious File Execution (T1204.002)'
def artifacts():
    return stats.collect(['destination_security_id', 'malware_name', 'file_path', 'event_action'])
def entity(event):
    return {'derived': False, 'value': event['destination_security_id'], 'type': 'host'}